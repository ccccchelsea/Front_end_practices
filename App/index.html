<!doctype html>
<html lang="en" class="no-js">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<link href='http://fonts.googleapis.com/css?family=Droid+Serif|Open+Sans:400,700' rel='stylesheet' type='text/css'>

	<link rel="stylesheet" href="css/reset.css"> <!-- CSS reset -->
	<link rel="stylesheet" href="css/style.css"> <!-- Resource style -->
	<script src="js/modernizr.js"></script> <!-- Modernizr -->
  	
	<title>Responsive Vertical Timeline</title>
	<style type="text/css">
	
	</style>
</head>
<body>
	<header>
		<h1>Responsive Vertical Timeline</h1>
	</header>

	<form id="search-form">
        <input type="text" id="query" value="" class="form-control" placeholder="Type an Artist Name"/>
        <input type="submit" id="search" class="btn btn-primary" value="Search" />
    </form>

    <div class="template hidden">

    	<div class="fixed_year">

    		<div class="cd-timeline-block">
				<div class="cd-timeline-img cd-picture">
					<p class="year"></p>
				</div> <!-- cd-timeline-img -->

				<div class="cd-timeline-content">

					<span class="cd-date"></span>

					<img src="" class="coverimage">
				<!-- <img src="foreground.png" class="foreground"> -->
					<div class="title_pop">
						<p class="title"></p>
						<p >POPULARITY: <span class="pop"></span></p>
					
					</div>
				
				</div> <!-- cd-timeline-content -->
			</div>
		</div>
	</div>
   
	<section id="cd-timeline" class="cd-container hidden">



	</section> <!-- cd-timeline -->

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script type="text/javascript">

var artist = "";
var albums = new Array();
var year=0;

document.getElementById('search-form').addEventListener('submit', function (e) {
    e.preventDefault();
    artist = document.getElementById('query').value;
    searchAlbums(artist);
});	

var dateTransfer= function(calendar){
	year = parseInt(calendar);
	var month = parseInt(calendar.slice(5,7));
	var date = parseInt(calendar.slice(8,10));
	var monthdate = 0;
	switch(month){
		case 1:
			monthdate = 0;
			break;
		case 2:
			monthdate = 31;
			break;
		case 3:
			monthdate = 31+28;
			break;
		case 4:
			monthdate = 31+28+31;
			break;
		case 5:
			monthdate = 31+28+31+30;
			break;
		case 6:
			monthdate = 31+28+31+30+31;
			break;
		case 7:
			monthdate = 31+28+31+30+31+30;
			break;
		case 8:
			monthdate = 31+28+31+30+31+30+31;
			break;
		case 9:
			monthdate = 31+28+31+30+31+30+31+31;
			break;
		case 10:
			monthdate = 31+28+31+30+31+30+31+31+30;
			break;
		case 11:
			monthdate = 31+28+31+30+31+30+31+31+30+31;
			break;
		case 12:
			monthdate = 31+28+31+30+31+30+31+31+30+31+30;
			break;


	}

	var total_date= monthdate + date;

	var top_distance= total_date+60;
	return top_distance.toString();

}

var Fixed_year= function(fixed_year){

}

var showAlbum = function(album){

	var result = $('.template .fixed_year').clone();

	if(album.album_type=="album"){


		var img = result.find('.coverimage');
		img.attr('src', album.images[0].url);

		var title = result.find('.title');
		title.text(album.name);

		var pop = result.find('.pop');
		pop.text(album.popularity);

		var top = result.find('.cd-timeline-content');
		top.css("top", dateTransfer(album.release_date)+"px");

		var calendar=result.find('.cd-date');
		calendar.text(album.release_date);

		var year_green=result.find('.year');
		year_green.text(year);



		return result;

	}

	
}

var fetchAlbum = function(albums){


	$(".cd-container").removeClass("hidden");


	$.each(albums.items, function(i, item){

		year_string=parseInt(item.release_date).toString();


		$.ajax({

			url: 'https://api.spotify.com/v1/albums/'+ item.id,
			data: {
				id: item.id
			},
			success: function(album){

				var html_content=showAlbum(album);
				$('.cd-container').append(html_content);

			}

		})
	

		
	});
}

var searchAlbums = function(query) {
    $.ajax({
        url: 'https://api.spotify.com/v1/search',
        data: {
            q: "artist:"+query,
            type: 'album'
        },

		success: function(response){


		fetchAlbum(response.albums);


		}

	});
        
}


</script>
<!-- <script src="js/main.js"></script> --> <!-- Resource jQuery -->
</body>
</html>